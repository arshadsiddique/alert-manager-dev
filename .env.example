# -----------------------------------------------------------------------------
# Devo Alert Manager Environment Configuration
#
# This file provides an example configuration. Copy it to a file named `.env`
# and fill in the values for your environment.
# -----------------------------------------------------------------------------

# =============================================================================
# REQUIRED CONFIGURATION
# These are the essential variables you must set for the application to run.
# =============================================================================

# --- Grafana Configuration ---
# The URL of your Grafana instance.
GRAFANA_API_URL="https://your-grafana-instance.com"

# An Admin-level API Key from your Grafana instance.
GRAFANA_API_KEY="your_grafana_api_key"


# --- Jira Service Management (JSM) Configuration ---
# The base URL of your Atlassian/Jira instance.
JIRA_URL="https://your-company.atlassian.net"

# The email address of the user for authenticating with the Jira API.
JIRA_USER_EMAIL="your.email@example.com"

# The API token for the Jira user. You can generate one at:
# https://id.atlassian.com/manage-profile/security/api-tokens
JIRA_API_TOKEN="your_jira_api_token"

# Your JSM Cloud ID. This is optional and will be retrieved automatically if
# left blank, but providing it can speed up the startup process.
JSM_CLOUD_ID=""


# =============================================================================
# APPLICATION & DATABASE CONFIGURATION
# Settings for the backend server and PostgreSQL database.
# =============================================================================

# The secret key used for signing sessions and other security purposes.
# Generate a random string for this value.
SECRET_KEY="your-super-secret-key-that-is-long-and-random"

# Set to "true" to enable debug mode, which provides more detailed error output.
# Recommended to keep as "false" in production.
DEBUG=false

# The connection string for the PostgreSQL database.
# The default value is configured to work with the included docker-compose.yaml.
DATABASE_URL="postgresql://user:password@postgres:5432/alertdb"


# =============================================================================
# FRONTEND CONFIGURATION
# Variables passed to the React frontend application.
# =============================================================================

# The base URL for your Jira instance, used to construct links in the UI.
# This should be the same value as JIRA_URL.
REACT_APP_JIRA_URL="https://your-company.atlassian.net"
REACT_APP_JSM_MODE="true"

APP_ENV=development
REACT_APP_DEV_API_URL="http://localhost:8000"
REACT_APP_STAGING_API_URL=""
REACT_APP_PROD_API_URL="https://api-dam.int.devo.com"

ALLOWED_ORIGINS=["https://dam.int.devo.com", "https://api-dam.int.devo.com"]

# =============================================================================
# CORE FEATURE & SYNC CONFIGURATION
# High-level settings for controlling application behavior.
# =============================================================================

# --- Feature Flags ---
# Enables or disables the core JSM integration features. Default is true.
USE_JSM_MODE=true

# If enabled, automatically closes a JSM alert when the corresponding
# alert in Grafana is resolved.
ENABLE_AUTO_CLOSE=true


# --- Sync & Filtering ---
# The interval (in seconds) at which to synchronize alerts from JSM.
JSM_SYNC_INTERVAL_SECONDS=300

# If set to "true", alerts from non-production environments will be ignored.
FILTER_NON_PROD_ALERTS=true

# A comma-separated list of cluster names to exclude if the above filter is enabled.
# Example: "dev,stage,test,qa"
EXCLUDED_CLUSTERS="stage,dev,test,staging,development"

# A comma-separated list of environment names to exclude.
EXCLUDED_ENVIRONMENTS="devo-stage-eu,staging,development,dev"


# =============================================================================
# ALERT MATCHING CONFIGURATION
# Fine-tune the algorithm that matches Grafana alerts to JSM alerts.
# =============================================================================

# The minimum confidence score (0-100) required to automatically match a
# Grafana alert with a JSM alert.
ALERT_MATCH_CONFIDENCE_THRESHOLD=70.0

# The confidence score (0-100) above which a match is considered to be of
# high confidence.
ALERT_MATCH_HIGH_CONFIDENCE_THRESHOLD=85.0

# The time window in minutes within which to search for matching alerts.
# For example, a value of 15 means the system will only try to match alerts
# that occurred within 15 minutes of each other.
ALERT_MATCH_TIME_WINDOW_MINUTES=15

# Enable or disable detailed logging of the matching process.
# Useful for debugging but can be noisy in production.
LOG_MATCHING_DETAILS=true


# =============================================================================
# DEPRECATED LEGACY JIRA SETTINGS
# This section is for backwards compatibility with older, non-JSM Jira issue
# tracking and is not used when USE_JSM_MODE is enabled.
# =============================================================================

# JIRA_PROJECT_KEY="OP"
# JIRA_INCIDENT_ISSUE_TYPE="Incident"
# JIRA_ACKNOWLEDGE_TRANSITION_NAME="To Do"
# JIRA_RESOLVE_TRANSITION_NAME="Completed"